(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{1401:function(e,t,a){"use strict";a.r(t);var r=a(39),n=a(40),o=a(624),s=a(664),l=a(18),c=a(0),i=a.n(c),u=a(131),d=a(633),p=a(724),g=a(911),m=a(567),f=a(723),h=a(660),y=a(701),E=a(702),v=a(942),C=a(673),b=a.n(C),w=a(50),x=a.n(w),N=a(625),j=a(679),S=a(1354),O=a(725);function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,r=Object(l.a)(e);if(t){var n=Object(l.a)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Object(s.a)(this,a)}}var k=function(e){Object(o.a)(a,e);var t=P(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(n.a)(a,[{key:"render",value:function(){var e=this;return i.a.createElement(O.a,{hover:!0,responsive:!0},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"Name"),i.a.createElement("th",null),i.a.createElement("th",null,"Sub Categories"))),i.a.createElement("tbody",null,this.props.categories.map(function(t,r){return i.a.createElement("tr",{key:t.id},i.a.createElement("td",null,r+1,". ",i.a.createElement(S.a,{to:"/".concat(e.props.typePath,"?category=").concat(t.id)},t.name)),i.a.createElement("td",null,i.a.createElement(m.a,{color:"inverse",size:"xs",onClick:function(){return e.props.editCategory(t)}},i.a.createElement("i",{className:"fa fa-edit"})),i.a.createElement(m.a,{color:"warning",size:"xs",onClick:function(){return e.props.deleteCategory(t)},disabled:t.children.length>0,title:t.children.length>0?"Can not delete category with childs":""},i.a.createElement("i",{className:"fa fa-trash"}))),i.a.createElement("td",null,i.a.createElement(m.a,{color:"success",size:"xs",onClick:function(){return e.props.addCategory(t)}},i.a.createElement("i",{className:"fa fa-plus"})," Add"),t.children.length>0&&i.a.createElement(a,{typePath:e.props.typePath,categories:t.children,addCategory:e.props.addCategory.bind(e),editCategory:e.props.editCategory.bind(e),deleteCategory:e.props.deleteCategory.bind(e)})))})))}}]),a}(i.a.Component),R=a(67);function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,r=Object(l.a)(e);if(t){var n=Object(l.a)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Object(s.a)(this,a)}}var z=function(e){Object(o.a)(a,e);var t=A(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={loading:!1,modal:!1,page:{number:0,size:20,totalElements:0,totalPages:0},filters:{search:""},type:"",typeName:"",typePath:"",categories:[],editFlag:!1,currentCategory:"",newCategory:{name:"",type:""},superCategory:"",addError:"",deleteError:"",updateError:""},e.updateParent=function(t,a){for(var r in t){var n=t[r];n.index=r,n.parent=a,n.children.length&&e.updateParent(n.children,n)}},e.searchUser=function(t){var a=t.target.value,r=e.state.filters;r.search=a,e.setState({filters:r},function(t){e.loadCategories()})},e.updateNewCategory=function(t){var a=e.state.newCategory;a.name=t.target.value,e.setState({newCategory:a})},e.toggleModal=function(){e.setState({modal:!e.state.modal})},e.addCategory=function(t){e.resetCategory(),e.setState({superCategory:t}),e.setState({editFlag:!1}),e.toggleModal()},e.editCategory=function(t){e.setState({newCategory:t}),e.setState({superCategory:t.parent}),e.setState({editFlag:!0}),e.toggleModal()},e.onSubmit=function(t){t.preventDefault();var a=R.j+R.d+"/api/categories/",r=e.state.newCategory;e.setState({loading:!0}),e.state.editFlag?(a+=e.state.newCategory.id,x.a.patch(a,{name:r.name}).then(function(t){if(e.toggleModal(),200===t.status){var a=e.state.categories,n=e.getChildrenArr(r,a);console.log(r),console.log(n),n[r.index]=r,e.setState({categories:a})}else e.setState({addError:t.response.data.globalErrors[0]}),b()("Unable to Edit!",t.response.data.globalErrors[0],"error")}).finally(function(){e.setState({loading:!1})})):(e.state.superCategory?(r.parentCategory=e.state.superCategory.id,r.lineage=(e.state.superCategory.lineage?e.state.superCategory.lineage:"$")+e.state.superCategory.id+"$"):r.menu=!0,r.uid=e.props.user.id,r.active=!0,x.a.post(a,r).then(function(t){if(e.toggleModal(),201===t.status){var a=e.state.categories,r=t.data;r.parent=e.state.superCategory,r.children=[];var n=e.getChildrenArr(r,a);n.unshift(t.data),n.forEach(function(e,t){e.index=t}),e.setState({categories:a})}else e.setState({addError:t.response.data.globalErrors[0]}),b()("Unable to Add!",t.response.data.globalErrors[0],"error")}).finally(function(){e.setState({loading:!1})}))},e.deleteCategory=function(t){b()({title:"Are you sure?",text:"You will not be able to recover this Category!",icon:"warning",dangerMode:!0,button:{text:"Yes, delete it!",closeModal:!0}}).then(function(a){a&&x.a.delete(R.j+R.d+"/api/categories/"+t.id).then(function(a){var r=e.state.categories,n=e.getChildrenArr(t,r);n.splice(t.index,1),n.forEach(function(e,t){e.index=t}),e.setState({categories:r})}).finally(function(){e.setState({loading:!1})}).catch(function(t){e.setState({deleteError:t.response.data.globalErrors[0]}),b()("Unable to Delete!",t.response.data.globalErrors[0],"error")})})},e}return Object(n.a)(a,[{key:"loadCategories",value:function(e){var t=this;e||(e=1);var a=R.j+R.d+"/api/categories?projection=category_all&lineage=null&sort=lineage,asc&page="+(e-1)+"&uid="+this.props.user.id;this.state.type&&(a+="&type="+this.state.type),this.state.filters.search&&(a+="&name="+encodeURIComponent("%"+this.state.filters.search+"%")),x.a.get(a).then(function(e){t.updateParent(e.data._embedded.categories,null),t.setState({categories:e.data._embedded.categories,page:e.data.page})})}},{key:"componentDidMount",value:function(){var e=this,t=this.props.match.path.substr(1);t=t.substr(0,t.indexOf("/"));var a=this.state.newCategory;a.type=t.substr(0,4);var r=t.endsWith("s")?t.substr(0,t.length-1):t;this.setState({typePath:t,type:a.type,typeName:r.charAt(0).toUpperCase()+r.slice(1),newCategory:a},function(t){e.loadCategories()})}},{key:"resetCategory",value:function(){var e={name:"",type:this.state.type};this.setState({newCategory:e})}},{key:"getIndexArr",value:function(e){for(var t=[];e.parent;)t.unshift(e.index),e=e.parent;return t.unshift(e.index),t}},{key:"getChildrenArr",value:function(e,t){var a=this.getIndexArr(e.parent),r=t;for(var n in a)r=r[a[n]].children;return r}},{key:"render",value:function(){var e=this;return i.a.createElement(d.a,null,this.state.loading&&i.a.createElement(u.a,null),i.a.createElement("style",null,".content-wrapper .btn { margin: 0 4px 4px 0 }"),i.a.createElement("div",{className:"content-heading"},this.state.typeName," Categories"),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-lg-12 col-md-12"},i.a.createElement(p.a,{className:"card-default"},i.a.createElement("div",{className:"card-header"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-md-2 offset-md-4"},i.a.createElement("h4",{className:"float-right"},"Filters : ")),i.a.createElement("div",{className:"col-md-4"},i.a.createElement(g.a,{type:"text",onChange:this.searchUser,value:this.state.filters.search,placeholder:"search category..."})),i.a.createElement("div",{className:"col-md-2"},i.a.createElement(m.a,{color:"success",size:"sm",className:"float-right",onClick:function(){return e.addCategory()}},i.a.createElement("i",{className:"fa fa-plus"}),"\xa0 Add Category")))),i.a.createElement(f.a,null,i.a.createElement(h.a,{isOpen:this.state.modal,toggle:this.toggleModal},i.a.createElement(y.a,{toggle:this.toggleModal},this.state.editFlag&&i.a.createElement("span",null,"Edit "),!this.state.editFlag&&i.a.createElement("span",null,"Add "),"Category"),i.a.createElement(E.a,null,i.a.createElement("form",{className:"form-horizontal",onSubmit:this.onSubmit},this.state.superCategory&&i.a.createElement("fieldset",null,i.a.createElement("div",{className:"form-category row mb"},i.a.createElement("label",{className:"col-md-4 col-form-label"},"Super Categories"),i.a.createElement(v.a,{md:8},i.a.createElement("h3",null,this.state.superCategory.name)))),i.a.createElement("fieldset",null,i.a.createElement("div",{className:"form-category row mb"},i.a.createElement("label",{className:"col-md-4 col-form-label"},"Name"),i.a.createElement(v.a,{md:8},i.a.createElement(g.a,{type:"text",onChange:this.updateNewCategory,maxLength:"20",value:this.state.newCategory.name,required:!0})))),i.a.createElement("fieldset",null,i.a.createElement("div",{className:"form-category row"},i.a.createElement("div",{className:"col-sm-12 text-center"},i.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Save Category"))))))),i.a.createElement(k,{typePath:this.state.typePath,categories:this.state.categories,addCategory:this.addCategory.bind(this),editCategory:this.editCategory.bind(this),deleteCategory:this.deleteCategory.bind(this)}),i.a.createElement(j.a,{page:this.state.page,onChange:function(t){return e.loadCategories(t)}}))))))}}]),a}(c.Component);t.default=Object(N.b)(function(e){return{settings:e.settings,user:e.login.userObj}})(z)},633:function(e,t,a){"use strict";var r=a(0),n=a.n(r),o=function(e){return n.a.createElement("div",{className:"content-wrapper"},e.unwrap?n.a.createElement("div",{className:"unwrap"},e.children):e.children)};o.defaultProps={unwrap:!1},t.a=o},679:function(e,t,a){"use strict";var r=a(851),n=a(39),o=a(40),s=a(624),l=a(664),c=a(18),i=a(0),u=a.n(i),d=a(751),p=a.n(d),g=a(852);function m(){var e=Object(r.a)(["\n    padding-top: 1em;\n    white-space: nowrap;\n    font-size: 16px;\n  "]);return m=function(){return e},e}function f(){var e=Object(r.a)(["\n    padding-top: 1em;\n    white-space: nowrap;\n    float: left;\n  "]);return f=function(){return e},e}function h(){var e=Object(r.a)(["\ndisplay: flex;\n-webkit-justify-content: flex-end;\njustify-content: flex-end;\nflex-direction: column;\nhite-space: nowrap;\ntext-align: right;\nmargin: 0px;\n\n"]);return h=function(){return e},e}function y(){var e=Object(r.a)(["\n    margin: 20px 10px 0;\n  "]);return y=function(){return e},e}function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,r=Object(c.a)(e);if(t){var n=Object(c.a)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Object(l.a)(this,a)}}var v=function(e){Object(s.a)(a,e);var t=E(a);function a(){var e;Object(n.a)(this,a);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).renderPagination=function(){var t=e.props.page.number*e.props.page.size+1,a=t+e.props.page.size-1;a>e.props.page.totalElements&&(a=e.props.page.totalElements);var r="Showing "+t+" to "+a+" of "+e.props.page.totalElements+" entries";return u.a.createElement("div",{className:"row text-center"},0===e.props.page.totalElements&&u.a.createElement("div",{className:"col-sm-12"},u.a.createElement(x,null,"No records found")),e.props.page.totalElements>0&&e.props.page.totalPages>1&&u.a.createElement("div",{className:"col-sm-12 col-md-5"},u.a.createElement(w,null,r)),e.props.page.totalElements>0&&e.props.page.totalPages>1&&u.a.createElement("div",{className:"col-sm-12 col-md-7"},u.a.createElement(b,null,u.a.createElement(p.a,{activePage:e.props.page.number+1,itemsCountPerPage:e.props.page.size,totalItemsCount:e.props.page.totalElements,pageRangeDisplayed:5,onChange:e.props.onChange,itemClass:"page-item",linkClass:"page-link",prevPageText:"<",nextPageText:">"}))))},e}return Object(o.a)(a,[{key:"render",value:function(){return u.a.createElement(C,null,u.a.createElement("style",null,"ul.pagination { white-space: nowrap; justify-content: flex-end; margin: 2px 0px; }"),this.renderPagination())}}]),a}(u.a.Component);t.a=v;var C=g.a.div(y()),b=g.a.div(h()),w=g.a.span(f()),x=g.a.span(m())}}]);
//# sourceMappingURL=24.0d842f96.chunk.js.map